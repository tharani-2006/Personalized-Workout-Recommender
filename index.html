<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personalized Workout Recommender</title>
    <style>
        /* Enhanced styling for better user experience */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            background-color: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 700;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .instructions {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .instructions h3 {
            margin-top: 0;
            color: white;
        }

        .instructions ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
        }

        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            min-height: 140px;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }

        textarea:focus {
            outline: none;
            border-color: #74b9ff;
            box-shadow: 0 0 0 3px rgba(116, 185, 255, 0.1);
        }

        button {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button:hover:not(:disabled) {
            background: linear-gradient(135deg, #00a085, #008f7a);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
        }

        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 10px;
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result.success {
            background: linear-gradient(135deg, #d1f2eb, #a3e4d7);
            border: 2px solid #00b894;
            color: #00695c;
        }

        .result.error {
            background: linear-gradient(135deg, #fadbd8, #f1948a);
            border: 2px solid #e74c3c;
            color: #c0392b;
        }

        .loading {
            text-align: center;
            color: #74b9ff;
            font-weight: 600;
        }

        .example {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid #e17055;
        }

        .example strong {
            color: #d63031;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background-color: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 10px;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #74b9ff, #0984e3);
            width: 0%;
            transition: width 0.3s ease;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .workout-type-card {
            display: inline-block;
            margin: 5px;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }

        .cardio-card {
            background-color: #ff7675;
            color: white;
        }

        .strength-card {
            background-color: #6c5ce7;
            color: white;
        }

        .mixed-card {
            background-color: #fd79a8;
            color: white;
        }

        .feature-highlight {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #74b9ff;
        }

        .tips {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 5px solid #4caf50;
        }

        .tips h4 {
            color: #2e7d32;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üí™ Your Personal Fitness Guide</h1>
        <p class="subtitle">Get Expert Workout Recommendations Based on Your Goals</p>

        <div class="instructions">
            <h3>üéØ Find Your Perfect Workout Style</h3>
            <p>Share your fitness details below, and we'll suggest the best training approach for your goals!</p>
            <ul>
                <li><strong>Your age:</strong> How old are you? (e.g., "I'm 25 years old")</li>
                <li><strong>Gender:</strong> Are you male or female?</li>
                <li><strong>Body stats:</strong> Your height and current weight</li>
                <li><strong>Fitness goal:</strong> What do you want to achieve? (lose weight, build muscle, stay healthy, etc.)</li>
                <li><strong>Gym experience:</strong> Are you new to fitness or have some experience?</li>
            </ul>
        </div>

        <div class="example">
            <strong>üí¨ Example (copy and modify for yourself):</strong><br>
            "Hi! I'm a 28-year-old woman, about 165 cm tall and weigh around 60 kg. I really want to lose some weight and get healthier overall. I've been to the gym a few times but I'm still pretty much a beginner. What kind of workout approach would work best for me?"
        </div>
        
        <form id="workoutForm">
            <div class="form-group">
                <label for="prompt">üí¨ Tell me about your fitness situation:</label>
                <textarea
                    id="prompt"
                    name="prompt"
                    placeholder="Share your details naturally! For example: 'I'm 32, male, about 175cm and 80kg. I want to get stronger and build some muscle. I go to the gym occasionally but I'm still learning the ropes...'"
                    required
                ></textarea>
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <button type="submit" id="submitBtn">
                <span id="buttonText">üí™ Find My Best Workout Style</span>
                <span id="loadingSpinner" style="display: none;">ü§î Thinking...</span>
            </button>
        </form>

        <div id="result" class="result">
            <div id="resultContent"></div>
        </div>

        <div class="tips">
            <h4>üí° Tips for the best recommendations:</h4>
            <ul>
                <li><strong>Be yourself:</strong> Share your real age, height, and weight - no judgment here!</li>
                <li><strong>Tell me your dreams:</strong> What do you really want to achieve with fitness?</li>
                <li><strong>Honest about experience:</strong> New to the gym? That's awesome! Been going for a while? Great!</li>
                <li><strong>Write naturally:</strong> Just talk to me like you're asking a friend for advice</li>
            </ul>
        </div>
    </div>

    <script>
        // JavaScript for handling form submission and API communication
        document.getElementById('workoutForm').addEventListener('submit', async function(e) {
            e.preventDefault(); // Prevent default form submission
            
            const submitBtn = document.getElementById('submitBtn');
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            const promptText = document.getElementById('prompt').value;
            
            // Validate input
            if (!promptText.trim()) {
                showError('Please enter your workout requirements.');
                return;
            }
            
            // Show enhanced loading state
            submitBtn.disabled = true;
            document.getElementById('buttonText').style.display = 'none';
            document.getElementById('loadingSpinner').style.display = 'inline';
            resultDiv.style.display = 'none';

            // Show progress bar animation
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');
            progressBar.style.display = 'block';

            // Animate progress bar
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 90) progress = 90;
                progressFill.style.width = progress + '%';
            }, 200);
            
            try {
                // Send request to Vercel API
                const response = await fetch('/api/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: promptText
                    })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showSuccess(data);
                } else {
                    showError(data.error || 'An error occurred while processing your request.');
                }
                
            } catch (error) {
                showError('Failed to connect to the server. Please try again.');
                console.error('Error:', error);
            } finally {
                // Reset button and progress bar state
                submitBtn.disabled = false;
                document.getElementById('buttonText').style.display = 'inline';
                document.getElementById('loadingSpinner').style.display = 'none';

                // Hide and reset progress bar
                clearInterval(progressInterval);
                progressBar.style.display = 'none';
                progressFill.style.width = '0%';
            }
        });
        
        function showSuccess(data) {
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');

            const prediction = data.prediction;
            const workoutType = prediction.workout_type;
            const confidence = prediction.confidence;
            const probabilities = prediction.probabilities;

            // Get workout type emoji and color
            const workoutTypeInfo = getWorkoutTypeInfo(workoutType);

            resultContent.innerHTML = `
                <div style="text-align: center; margin-bottom: 25px;">
                    <h2 style="margin: 0; color: #2c3e50;">Perfect! Here's what I recommend for you:</h2>
                    <div style="font-size: 3.5em; margin: 15px 0;">${workoutTypeInfo.emoji}</div>
                    <h3 style="margin: 0; color: ${workoutTypeInfo.color}; font-size: 2em; font-weight: 700;">
                        ${workoutType}
                    </h3>
                    <p style="font-size: 1.1em; color: #7f8c8d; margin: 10px 0;">
                        I'm <strong>${confidence}% confident</strong> this is the right fit for you
                    </p>
                </div>

                <div class="feature-highlight">
                    <h4>üéØ Why this works for you:</h4>
                    <p>${getWorkoutTypeExplanation(workoutType)}</p>
                </div>

                <h4>üìä Here's how I see your fitness match:</h4>
                <div style="display: flex; justify-content: space-between; margin: 15px 0; flex-wrap: wrap; gap: 10px;">
                    <div class="workout-type-card cardio-card">
                        üèÉ Endurance Training: ${probabilities['Endurance Training'] || probabilities.cardio}%
                    </div>
                    <div class="workout-type-card mixed-card">
                        üîÑ Balanced Fitness: ${probabilities['Balanced Fitness'] || probabilities.mixed}%
                    </div>
                    <div class="workout-type-card strength-card">
                        üí™ Muscle Building: ${probabilities['Muscle Building'] || probabilities.strength}%
                    </div>
                </div>

                <div class="feature-highlight">
                    <h4>üöÄ Your next steps (my personal advice):</h4>
                    <ul>
                        <li><strong>Start small:</strong> 3 workouts per week is perfect to begin with</li>
                        <li><strong>Form first:</strong> Learn proper technique before adding weight or intensity</li>
                        <li><strong>Listen to your body:</strong> Rest when you need it, push when you feel good</li>
                        <li><strong>Stay consistent:</strong> Small, regular efforts beat sporadic intense sessions</li>
                        <li><strong>Track your wins:</strong> Celebrate every improvement, no matter how small!</li>
                    </ul>
                </div>

                <div style="text-align: center; margin-top: 25px;">
                    <button onclick="resetForm()" style="width: auto; padding: 12px 25px; background: #6c757d; border-radius: 25px;">
                        üîÑ Get Another Recommendation
                    </button>
                </div>
            `;

            resultDiv.className = 'result success';
            resultDiv.style.display = 'block';

            // Scroll to results
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }
        
        function showError(message) {
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');

            resultContent.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 3em; margin-bottom: 15px;">ü§î</div>
                    <h3 style="color: #c0392b; margin-bottom: 15px;">Hmm, I need a bit more info!</h3>
                    <p style="font-size: 1.1em; margin-bottom: 20px;">I couldn't quite understand your request. Let me help you out!</p>

                    <div class="feature-highlight">
                        <h4>üí¨ Here's what I need to give you great advice:</h4>
                        <ul style="text-align: left;">
                            <li><strong>Your age:</strong> Just tell me how old you are</li>
                            <li><strong>Gender:</strong> Are you male or female?</li>
                            <li><strong>Your size:</strong> Height and weight (helps me understand your body type)</li>
                            <li><strong>Your goal:</strong> What do you want to achieve? (lose weight, get stronger, etc.)</li>
                            <li><strong>Gym experience:</strong> New to this or have some experience?</li>
                        </ul>
                        <p style="margin-top: 15px;"><strong>üí° Pro tip:</strong> Just write it like you're texting a friend who knows about fitness!</p>
                    </div>

                    <button onclick="resetForm()" style="width: auto; padding: 12px 25px; background: #e74c3c; margin-top: 15px; border-radius: 25px;">
                        üí¨ Let me try again
                    </button>
                </div>
            `;

            resultDiv.className = 'result error';
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function getWorkoutTypeInfo(workoutType) {
            // Map both technical and human-friendly names
            const workoutInfo = {
                'cardio': { emoji: 'üèÉ‚Äç‚ôÇÔ∏è', color: '#e74c3c' },
                'strength': { emoji: 'üí™', color: '#8e44ad' },
                'mixed': { emoji: 'üîÑ', color: '#e91e63' },
                'Endurance Training': { emoji: 'üèÉ‚Äç‚ôÇÔ∏è', color: '#e74c3c' },
                'Muscle Building': { emoji: 'üí™', color: '#8e44ad' },
                'Balanced Fitness': { emoji: 'üîÑ', color: '#e91e63' }
            };

            return workoutInfo[workoutType] || { emoji: 'üèãÔ∏è', color: '#34495e' };
        }

        function getWorkoutTypeExplanation(workoutType) {
            // Convert to technical name if needed
            const technicalName = workoutType.toLowerCase().includes('endurance') ? 'cardio' :
                                 workoutType.toLowerCase().includes('muscle') ? 'strength' :
                                 workoutType.toLowerCase().includes('balanced') ? 'mixed' : workoutType;

            const explanations = {
                'cardio': "This is perfect for you! Endurance training will help you burn calories, strengthen your heart, and build amazing stamina. Think running, cycling, swimming, or fun dance workouts. You'll feel energized and see great results with fat loss and overall fitness.",
                'strength': "Excellent choice for your goals! Muscle building workouts will help you get stronger, more toned, and boost your metabolism. Focus on lifting weights, resistance exercises, and bodyweight movements. You'll love seeing your strength improvements week by week!",
                'mixed': "This is ideal for you! Balanced fitness gives you the best of everything - you'll build muscle AND improve your cardio fitness. Mix weight training with cardio activities throughout the week. It's perfect for overall health and keeps workouts interesting!"
            };

            return explanations[technicalName] || 'A workout approach that matches your personal goals and fitness level perfectly.';
        }

        function resetForm() {
            document.getElementById('prompt').value = '';
            document.getElementById('result').style.display = 'none';
            document.getElementById('prompt').focus();
        }

        // Add input validation and character counter
        document.getElementById('prompt').addEventListener('input', function(e) {
            const text = e.target.value;
            const minLength = 50;
            const submitBtn = document.getElementById('submitBtn');

            if (text.length < minLength) {
                submitBtn.style.opacity = '0.6';
                submitBtn.title = `Please provide more details (${text.length}/${minLength} characters minimum)`;
            } else {
                submitBtn.style.opacity = '1';
                submitBtn.title = 'Click to get your workout recommendation';
            }
        });

        // Auto-focus on the textarea when page loads
        window.addEventListener('load', function() {
            document.getElementById('prompt').focus();
        });
    </script>
</body>
</html>
